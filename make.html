<html>
	<head>
		<title>新建</title>
		<meta http-equiv="charset" content="text/html" charset="utf-8"/>
		<script src="js/PJ.js"></script>
		<script>
			Initialize();
			var labels = [];//选项数组
			function existLabel(str){
				for(x=0;x<labels.length;x++)
					if(labels[x]==str)
						return true;
				return false;
			}
			window.onload = function(){
				dWidth = GetWindowWidth()-20;
				dHeight = GetWindowHeight()/10;
				
				S(document.body).overflowX = "hidden";
				S(document.body).height = dHeight * 18 +60;				
				
				Html("back","后退");
				Position("back","absolute");
				S("back").width = dWidth;
				S("back").height = dHeight;
				S("back").top = 10;
				S("back").left = 10;
				Opacity("back",70);
				S("back").cursor = "default";
				S("back").fontSize = dHeight*0.8;
				S("back").color = "white";
				S("back").backgroundColor = "blue";
				O("back").onmouseover = function(){Opacity(this,90);};
				O("back").onmouseout = function(){Opacity(this,70);};
				O("back").onclick = function(){location.href = "index.html";};

				Html("title","标题");
				Position("title","absolute");
				S("title").width = dWidth * 0.3;
				S("title").height = dHeight;
				S("title").top = dHeight + 20;
				S("title").left  = 10;
				Opacity("title",70);
				S("title").cursor = "default";
				S("title").fontSize = dHeight * 0.8;
				S("title").color = "white";
				S("title").backgroundColor = "purple";

				Position("ipt-title","absolute");
				S("ipt-title").width = dWidth * 0.7;
				S("ipt-title").height = dHeight;
				S("ipt-title").top = dHeight + 20;
				S("ipt-title").left = 10 + dWidth * 0.3;
				Opacity("ipt-title",70);
				S("ipt-title").cursor = "default";
				S("ipt-title").fontSize = dHeight * 0.8;
				S("ipt-title").color = "white";
				S("ipt-title").backgroundColor = "blue";
				S("ipt-title").border = "5px solid purple";
				O("ipt-title").onmouseover = function(){Opacity(this,90);};
				O("ipt-title").onmouseout = function(){Opacity(this,70);};

				Html("describes","描述");
				Position("describes","absolute");
				S("describes").width = dWidth;
				S("describes").height = dHeight;
				S("describes").top = dHeight * 3 + 40;
				S("describes").left = 10;
				Opacity("describes",70);
				S("describes").cursor = "default";
				S("describes").fontSize = dHeight * 0.8;
				S("describes").color = "white";
				S("describes").backgroundColor = "green";


				Position("ipt-describes","absolute");
				S("ipt-describes").width = dWidth;
				S("ipt-describes").height = dHeight * 6;
				S("ipt-describes").top = dHeight * 4 + 40;
				S("ipt-describes").left = 10;
				Opacity("ipt-describes",70);
				S("ipt-describes").cursor = "default";
				S("ipt-describes").fontSize = dHeight * 0.5;
				S("ipt-describes").color = "white";
				S("ipt-describes").backgroundColor = "black";
				S("ipt-describes").resize = "none";
				S("ipt-describes").border = 0;
				O("ipt-describes").onmouseover = function(){Opacity(this,90);};
				O("ipt-describes").onmouseout = function(){Opacity(this,70);};

				Html("password","密码");
				Position("password","absolute");
				S("password").width = dWidth * 0.3;
				S("password").height = dHeight;
				S("password").top = dHeight * 2 + 30;
				S("password").left = 10;
				Opacity("password",70);
				S("password").cursor = "default";
				S("password").fontSize = dHeight * 0.8;
				S("password").color = "white";
				S("password").backgroundColor = "red";

				Position("ipt-password","absolute");
				S("ipt-password").width = dWidth * 0.7;
				S("ipt-password").height = dHeight;
				S("ipt-password").top = dHeight * 2 +30;
				S("ipt-password").left = 10 + dWidth*0.3;
				Opacity("ipt-password",70);
				S("ipt-password").cursor = "default";
				S("ipt-password").fontSize = dHeight * 0.7;
				S("ipt-password").color = "white";
				S("ipt-password").backgroundColor = "gray";
				S("ipt-password").border = "5px solid red";
				O("ipt-password").type = "password";
				O("ipt-password").onmouseover = function(){Opacity(this,90);};
				O("ipt-password").onmouseout = function(){Opacity(this,70);};



				Html("options","选项 - 单击删除");
				Position("options","absolute");
				S("options").width = dWidth;
				S("options").height = dHeight;
				S("options").top = dHeight * 10 + 50;
				S("options").left = 10;
				Opacity("options",70);
				S("options").cursor = "default";
				S("options").fontSize = dHeight * 0.8;
				S("options").color = "white";
				S("options").backgroundColor = "green";

				Position("labels","absolute");
				S("labels").width = dWidth;
				S("labels").height = dHeight * 5;
				S("labels").top = dHeight * 11 + 50;
				S("labels").left = 10;
				Opacity("labels",70);
				S("labels").cursor = "default";
				S("labels").fontSize = dHeight * 0.7;
				S("labels").color = "white";
				S("labels").backgroundColor = "blue";
				//O("labels").onmouseover = function(){Opacity(this,90);};
				//O("labels").onmouseout = function(){Opacity(this,70);};
				S("labels").overflow = "auto";

				Html("add","添加");
				Position("add","absolute");
				S("add").width = (dWidth) * 0.3;
				S("add").height = dHeight;
				S("add").top = dHeight * 16 + 50;
				S("add").left = dWidth*0.7+10;
				Opacity("add",70);
				S("add").cursor = "default";
				S("add").fontSize = dHeight * 0.8;
				S("add").color = "white";
				S("add").backgroundColor = "red";
				O("add").onmouseover = function(){Opacity(this,90);};
				O("add").onmouseout = function(){Opacity(this,70);};
				O("add").onclick = function(){
					if(O("ipt-label").value=="")return;
					if(!existLabel(O("ipt-label").value)){
						labels.push(O("ipt-label").value);
						var obj = document.createElement("div");
						Html(obj,O("ipt-label").value);
						S(obj).backgroundColor = "black";
						S(obj).wordBreak = "break-all";
						obj.onmouseover = function(){
							S(this,"backgroundColor","blue");
						};
						obj.onmouseout = function(){
							S(this,"backgroundColor","black");
						};
						obj.onclick = function(){
							for(x=0;x<labels.length;x++)
								if(labels[x]==Html(this))
									labels.splice(x,1);
							O("labels").removeChild(this);
						};
						O("labels").appendChild(obj);
					}
					O("ipt-label").value = "";
					//Alert(labels.toString());
				};

				Position("ipt-label","absolute");
				S("ipt-label").width = dWidth * 0.7;
				S("ipt-label").height = dHeight;
				S("ipt-label").top = dHeight * 16 + 50;
				S("ipt-label").left = 10;
				Opacity("ipt-label",70);
				S("ipt-label").cursor = "default";
				S("ipt-label").fontSize = dHeight * 0.7;
				S("ipt-label").color = "white";
				S("ipt-label").backgroundColor = "blue";
				O("ipt-label").onmouseover = function(){Opacity(this,90);};
				O("ipt-label").onmouseout = function(){Opacity(this,70);};
				S("ipt-label").border = "5px solid red";

				Html("submit","提交");
				Position("submit","absolute");
				S("submit").width = dWidth;
				S("submit").height = dHeight;
				S("submit").top = dHeight*17 +60;
				S("submit").left = 10;
				Opacity("submit",70);
				S("submit").cursor = "default";
				S("submit").fontSize = dHeight * 0.8;
				S("submit").color = "white";
				S("submit").backgroundColor = "purple";
				O("submit").onmouseover = function(){Opacity(this,90);};
				O("submit").onmouseout = function(){Opacity(this,70);};
				O("submit").can = true;
				O("submit").onclick = function(){
					if(!this.can)return;
					if(confirm("确定提交?(提交后无法修改)")){
						Html(this,"提交中..");
						this.can = false;
						var args = "title=" + encodeURIComponent(O("ipt-title").value);
						args += "&password=" + encodeURIComponent(O("ipt-password").value);
						args += "&describe=" + encodeURIComponent(O("ipt-describes").value);
						args += "&cnt=" + encodeURIComponent(labels.length);
						for(var i=0;i<labels.length;i++)
							args += "&label" + i + "=" + encodeURIComponent(labels[i]);
						function callback(){
							this.can = true;
							//alert(this);//
							var obj = eval("("+this+")");
							if(obj.stat==0){
								Html("submit",obj.str);
								//location.href = "index.html";
							}else{
								alert(obj.str);
								Html("submit","提交");
								O("submit").can = true;
							}
						};
						//if(confirm(args))
						PostAjaxRequest(callback,"act/make.php",args);
					}
				};
			};
		</script>
	</head>
	<body>
		<div id="back"></div>
		<div id="title"></div>
		<input id="ipt-title"/>
		<div id="password"></div>
		<input id="ipt-password"/>
		<div id="describes"></div>
		<textarea id="ipt-describes"></textarea>
		<div id="options"></div>
		<div id="labels"></div>
		<div id="add"></div>
		<input id="ipt-label"/>
		<div id="submit"></div>
	</body>
</html>